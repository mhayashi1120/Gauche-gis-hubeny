#!/usr/bin/env gosh
;; Configuring Gauche-gis-hubeny
;; Run ./configure (or gosh ./configure) to generate Makefiles.

(use gauche.configure)
(load "configure-compat"
      :paths `(,(sys-dirname (current-load-path)))
      :error-if-not-found #f)

;; Here you can define handlers of configure arguments by cf-arg-enable
;; and cf-arg-with.  Note that --with-local is handled implicitly if you use
;; cf-init-gauche-extension.


;; Initialize configure.  This creates the global context, parses
;; command-line args and sets up default values.
(cf-init-gauche-extension)

;; Here you can add feature tests and other cf-define's.

;; Output
(cf-output-default)

(define (compute-constants a b)
  (let* ((e (sqrt (/ (- (expt a 2) (expt b 2))
                     (expt a 2))))
         (e^2 (expt e 2))
         (M-numerator (* a (- 1 e^2))))
    (list a e^2 M-numerator)))

(cf-subst 'BESSEL_CONSTANTS (x->string (compute-constants 6377397.155 6356079.0)))
(cf-subst 'GRS80_CONSTANTS (x->string (compute-constants 6378137.0 6356752.314140)))
(cf-subst 'WGS84_CONSTANTS (x->string (compute-constants 6378137.0 6356752.314245)))

(cf-output "gis/hubeny.scm")

;; Local variables:
;; mode: scheme
;; end:
